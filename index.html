<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LESSON PLANNER Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Arial&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --bg-app: #e2e8f0; --paper-width: 297mm; --paper-height: 210mm; } 
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Roboto', sans-serif; background: var(--bg-app); height: 100vh; display: flex; overflow: hidden; color: #334155; }
        .sidebar { width: 380px; background: white; border-right: 1px solid #cbd5e1; display: flex; flex-direction: column; overflow-y: auto; z-index: 10; flex-shrink: 0; }
        .sidebar-header { padding: 20px; background: var(--primary); color: white; }
        .sidebar-header h2 { font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { font-size: 0.8rem; opacity: 0.8; }
        .sidebar-content { padding: 20px; display: flex; flex-direction: column; gap: 12px; }
        .section-label { font-size: 0.7rem; font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; margin-top: 10px; border-bottom: 2px solid #f1f5f9; padding-bottom: 5px; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 700; color: #475569; margin-bottom: 4px; }
        .input-error { border: 2px solid #ef4444 !important; background-color: #fef2f2 !important; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 0.9rem; font-family: 'Roboto', sans-serif; background: #f8fafc; }
        textarea { resize: vertical; min-height: 50px; }
        .row { display: flex; gap: 10px; }
        .row > div { flex: 1; }
        .btn-generate { background: var(--accent); color: white; border: none; padding: 12px; border-radius: 6px; font-weight: 700; cursor: pointer; width: 100%; margin-top: 15px; display: flex; justify-content: center; align-items: center; gap: 8px; transition: 0.2s; }
        .btn-generate:hover { background: #1d4ed8; }
        .btn-group { display: flex; flex-direction: column; gap: 8px; margin-top: 10px; }
        .btn-secondary { padding: 10px; border: 1px solid #cbd5e1; background: white; border-radius: 6px; font-weight: 600; color: #334155; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 5px; font-size: 0.8rem; transition: 0.2s; width: 100%; }
        .btn-home-back { background: linear-gradient(45deg, #1e3a8a, #2563eb, #3b82f6); background-size: 200% 200%; animation: gradientBG 6s ease infinite; color: white; border: none; padding: 12px; border-radius: 50px; font-weight: 700; cursor: pointer; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3); transition: all 0.3s ease; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.5px; margin-bottom: 10px; }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .preview-area { flex: 1; background: #cbd5e1; padding: 30px; overflow-y: auto; display: flex; justify-content: center; }
        .bond-paper { background: white; width: var(--paper-width); min-height: var(--paper-height); padding: 10mm; box-shadow: 0 10px 40px rgba(0,0,0,0.15); margin-bottom: 50px; position: relative; display: flex; flex-direction: column; color: black; font-family: Arial, Helvetica, sans-serif; transition: width 0.3s ease; }
        .official-header { text-align: center; margin-bottom: 15px; font-family: "Bookman Old Style", serif; }
        .official-header img { height: 60px; margin-bottom: 5px; }
        .official-header h5 { margin: 0; font-size: 9pt; font-weight: normal; }
        .official-header h4 { margin: 2px 0; font-size: 10pt; font-weight: bold; text-transform: uppercase; }
        .tpl-table { width: 100%; border-collapse: collapse; margin-bottom: 15px; font-size: 9pt; table-layout: fixed; }
        .tpl-table td, .tpl-table th { border: 1px solid black; padding: 4px; vertical-align: top; word-wrap: break-word; overflow-wrap: break-word; white-space: pre-wrap; }
        .header-label { width: 15%; background: #eee; text-align: left; font-weight: bold; vertical-align: middle; font-size: 8pt; }
        .header-val { width: 35%; font-weight: bold; font-size: 9pt;}
        .dll-grid th { background: #d1d5db; text-align: center; font-weight: bold; font-size: 8pt; vertical-align: middle; }
        .dll-row-header { background: #f3f4f6; font-weight: bold; width: 150px; }
        .signature-section { margin-top: auto; padding-top: 20px; font-size: 9pt; page-break-inside: avoid; display: flex; justify-content: space-between; }
        .sig-block { width: 45%; }
        .sig-name { font-weight: bold; text-transform: uppercase; border-bottom: 1px solid black; display: block; text-align: center; margin-top: 30px; }
        .sig-pos { font-size: 8pt; text-align: center; display: block; margin-top: 4px; }
        .spinner { display: none; width: 16px; height: 16px; border: 2px solid #fff; border-bottom-color: transparent; border-radius: 50%; animation: rotation 1s linear infinite; }
        @keyframes rotation { to { transform: rotate(360deg); } }
        .parsed-md ul, .parsed-md ol { padding-left: 15px; margin: 0; }
        @media print {
            @page { size: A4 landscape; margin: 5mm; }
            body { background: white; display: block; height: auto; }
            .sidebar { display: none; }
            .preview-area { padding: 0; background: white; display: block; }
            .bond-paper { box-shadow: none; margin: 0; padding: 0; width: 100% !important; border: none; transform: scale(0.98); transform-origin: top left; }
            .btn-group { display: none; }
        }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">
        <h2>COGON NATIONAL HIGH SCHOOL</h2>
        <p>LESSON PLANNER Pro</p>
    </div>
    <div class="sidebar-content">
        <button class="btn-home-back" onclick="window.location.href='https://cogonnationalhighschool.com/'">
            <i class="fa-solid fa-school"></i> Go to CNHS Website
        </button>
        <div class="section-label">I. Configuration</div>
        <div class="form-group">
            <label>Document Type *</label>
            <select id="docType" onchange="toggleInputs()">
                <option value="" disabled selected>Select Document Type...</option>
                <option value="DLP">Detailed Lesson Plan (DLP)</option>
                <option value="DLL">Daily Lesson Log (DLL - 1 Week)</option>
            </select>
        </div>
        <div class="form-group"><label>School Name</label><input type="text" id="school" value="COGON NATIONAL HIGH SCHOOL" oninput="liveUpdateHeader()"></div>
        <div id="dlp-date-group" style="display:none;">
            <div class="form-group"><label>Teacher *</label><input type="text" id="teacher" placeholder="Name"></div>
            <div class="row">
                <div class="form-group"><label>Teaching Date *</label><input type="date" id="dlp-date" onchange="renderEmptyLayout()"></div>
                <div class="form-group"><label>Teaching Time *</label><input type="text" id="dlp-time" placeholder="e.g. 8:00 - 9:00 AM" oninput="renderEmptyLayout()"></div>
            </div>
        </div>
        <div id="dll-date-group" style="display:none;">
            <div class="form-group"><label>Teacher *</label><input type="text" id="teacher-dll" placeholder="Name"></div>
            <div class="form-group"><label>Teaching Time *</label><input type="text" id="dll-time" placeholder="e.g. 8:00 - 9:00 AM" oninput="renderEmptyLayout()"></div>
            <div class="section-label" style="margin-top:5px; margin-bottom:5px;">Select Dates (At least one)</div>
            <div class="row">
                <div class="form-group"><label>Day 1</label><input type="date" id="date-d1" onchange="renderEmptyLayout()"></div>
                <div class="form-group"><label>Day 2</label><input type="date" id="date-d2" onchange="renderEmptyLayout()"></div>
            </div>
            <div class="row">
                <div class="form-group"><label>Day 3</label><input type="date" id="date-d3" onchange="renderEmptyLayout()"></div>
                <div class="form-group"><label>Day 4</label><input type="date" id="date-d4" onchange="renderEmptyLayout()"></div>
            </div>
            <div class="form-group"><label>Day 5</label><input type="date" id="date-d5" onchange="renderEmptyLayout()"></div>
        </div>
        <div class="row">
            <div class="form-group">
                <label>Grade Level *</label>
                <select id="grade" onchange="renderEmptyLayout()">
                    <option value="" disabled selected>Select Grade...</option>
                    <option value="Grade 1">Grade 1</option><option value="Grade 2">Grade 2</option><option value="Grade 3">Grade 3</option><option value="Grade 4">Grade 4</option><option value="Grade 5">Grade 5</option><option value="Grade 6">Grade 6</option><option value="Grade 7">Grade 7</option><option value="Grade 8">Grade 8</option><option value="Grade 9">Grade 9</option><option value="Grade 10">Grade 10</option><option value="Grade 11">Grade 11</option><option value="Grade 12">Grade 12</option>
                </select>
            </div>
            <div class="form-group">
                <label>Quarter *</label>
                <select id="quarter" onchange="renderEmptyLayout()">
                    <option value="" disabled selected>Select Quarter...</option>
                    <option value="1st Quarter">1st Quarter</option><option value="2nd Quarter">2nd Quarter</option><option value="3rd Quarter">3rd Quarter</option><option value="4th Quarter">4th Quarter</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label>Subject *</label>
            <select id="subjectSelect" onchange="handleSubjectChange()">
                <option value="" disabled selected>Select Subject...</option>
                <option value="Science">Science</option><option value="Mathematics">Mathematics</option><option value="English">English</option><option value="Filipino">Filipino</option><option value="Araling Panlipunan">Araling Panlipunan</option><option value="MAPEH">MAPEH</option><option value="TLE">TLE</option><option value="ESP">ESP</option><option value="Empowerment Technologies">Empowerment Technologies</option><option value="Introduction to Philosophy">Introduction to Philosophy</option><option value="Oral Communication">Oral Communication</option><option value="Manual">Enter Manually...</option>
            </select>
            <input type="text" id="subjectManual" placeholder="Type Subject Name" style="display:none; margin-top:5px;" oninput="renderEmptyLayout()">
        </div>
        <div class="form-group"><label>Section *</label><input type="text" id="section" placeholder="Section Name"></div>
        <div class="section-label">II. Lesson Content</div>
        <div class="form-group"><label>Topic *</label><input type="text" id="topic" placeholder="e.g. Plate Tectonics"></div>
        <div class="form-group"><label>Content Stds *</label><textarea id="cs" placeholder="Demonstrates..."></textarea></div>
        <div class="form-group"><label>Perf. Stds *</label><textarea id="ps" placeholder="Is able to..."></textarea></div>
        <div class="form-group"><label>Competency *</label><textarea id="lc" placeholder="Code..."></textarea></div>
        <div class="section-label">III. Settings</div>
        <div class="form-group">
            <label>Instructional Model *</label>
            <select id="model">
                <option value="" disabled selected>Select Model...</option>
                <option value="4As">4A's (Activity, Analysis, Abstraction, Application)</option><option value="5Es">5E's (Engage, Explore, Explain, Elaborate, Evaluate)</option><option value="7Es">7E's (Elicit, Engage, Explore, Explain, Elaborate, Evaluate, Extend)</option>
            </select>
        </div>
        <div class="section-label">IV. Signatories</div>
        <div class="row">
            <div class="form-group"><label>Teacher Pos *</label><input type="text" id="teacherPos" placeholder="Teacher I"></div>
            <div class="form-group"><label>Checker *</label><input type="text" id="checker" placeholder="Head Name"></div>
        </div>
        <div class="form-group"><label>Checker Pos *</label><input type="text" id="checkerPos" placeholder="Principal III"></div>
        <button class="btn-generate" onclick="generatePlan()">
            <span class="spinner" id="spin"></span> <span id="btnText">Generate Plan</span>
        </button>
        <div class="btn-group">
            <button class="btn-secondary" onclick="window.print()"><i class="fa-solid fa-print"></i> PRINT</button>
            <button class="btn-secondary" onclick="downloadPDF()"><i class="fa-solid fa-file-pdf"></i> Download PDF</button>
            <button class="btn-secondary" onclick="exportToWord()"><i class="fa-solid fa-file-word"></i> Download WORD</button>
        </div>
    </div>
</div>

<div class="preview-area">
    <div class="bond-paper" id="paperContent">
        <div class="official-header">
            <img id="headerLogo" src="logo.png" alt="Logo" crossorigin="anonymous" onerror="this.style.display='none'">
            <h5>Republic of the Philippines</h5>
            <h5>Department of Education</h5>
            <h5>Region XI</h5>
            <h4 id="displaySchoolHeader">COGON NATIONAL HIGH SCHOOL</h4>
            <h5>Division of the Island Garden City of Samal</h5>
        </div>
        <div id="headerArea"></div>
        <div id="contentArea"></div>
        <div class="signature-section">
            <div class="sig-block"><div>PREPARED BY:</div><div class="sig-name" id="sigTeacherName"></div><div class="sig-pos" id="sigTeacherPos"></div></div>
            <div class="sig-block"><div>CHECKED BY:</div><div class="sig-name" id="sigCheckerName"></div><div class="sig-pos" id="sigCheckerPos"></div></div>
        </div>
    </div>
</div>

<script>
    function toggleInputs() {
        const type = document.getElementById('docType').value;
        const dlpGroup = document.getElementById('dlp-date-group');
        const dllGroup = document.getElementById('dll-date-group');
        if(type === 'DLL') { dlpGroup.style.display = 'none'; dllGroup.style.display = 'block'; } 
        else { dlpGroup.style.display = 'block'; dllGroup.style.display = 'none'; }
        renderEmptyLayout(); 
    }
    function handleSubjectChange() {
        const select = document.getElementById('subjectSelect');
        document.getElementById('subjectManual').style.display = (select.value === 'Manual') ? 'block' : 'none';
        renderEmptyLayout();
    }
    function getInputs() {
        const type = document.getElementById('docType').value;
        const teacherName = type === 'DLL' ? document.getElementById('teacher-dll').value : document.getElementById('teacher').value;
        const teachingTime = type === 'DLP' ? document.getElementById('dlp-time').value : document.getElementById('dll-time').value;
        let subj = document.getElementById('subjectSelect').value;
        if (subj === 'Manual') subj = document.getElementById('subjectManual').value;
        return {
            docType: type, school: document.getElementById('school').value, teacher: teacherName,
            dlpDate: document.getElementById('dlp-date').value, teachingTime: teachingTime,
            dates: [document.getElementById('date-d1').value, document.getElementById('date-d2').value, document.getElementById('date-d3').value, document.getElementById('date-d4').value, document.getElementById('date-d5').value],
            grade: document.getElementById('grade').value, subject: subj, quarter: document.getElementById('quarter').value,
            section: document.getElementById('section').value, topic: document.getElementById('topic').value, 
            cs: document.getElementById('cs').value, ps: document.getElementById('ps').value, lc: document.getElementById('lc').value,
            model: document.getElementById('model').value, teacherPos: document.getElementById('teacherPos').value,
            checker: document.getElementById('checker').value, checkerPos: document.getElementById('checkerPos').value
        };
    }
    function liveUpdateHeader() { document.getElementById('displaySchoolHeader').innerText = document.getElementById('school').value.toUpperCase(); renderEmptyLayout(); }
    
    function extractSection(text, tagName) {
        const regex = new RegExp(`<${tagName}>([\\s\\S]*?)<\/${tagName}>`, 'i');
        const match = text.match(regex);
        return match ? match[1].trim() : null;
    }

    function renderEmptyLayout() {
        const data = getInputs();
        document.getElementById('sigTeacherName').innerText = (data.teacher || "").toUpperCase();
        document.getElementById('sigTeacherPos').innerText = (data.teacherPos || "").toUpperCase();
        document.getElementById('sigCheckerName').innerText = (data.checker || "").toUpperCase();
        document.getElementById('sigCheckerPos').innerText = (data.checkerPos || "").toUpperCase();
        const isDLP = data.docType === 'DLP';
        const colSpan = isDLP ? 1 : 5;
        const colsHTML = isDLP ? `<th>Detailed Content</th>` : data.dates.map((d, i) => `<th style="width:18%">${d ? 'Day '+(i+1)+'<br>'+d : 'Day '+(i+1)}</th>`).join('');
        const dateDisplay = isDLP ? data.dlpDate : data.dates.filter(d => d).join(' / ');
        document.getElementById('headerArea').innerHTML = `<table class="tpl-table"><tr><td class="header-label">School</td><td class="header-val">${data.school.toUpperCase()}</td><td class="header-label">Grade Level</td><td class="header-val">${data.grade}</td></tr><tr><td class="header-label">Teacher</td><td class="header-val">${(data.teacher||"").toUpperCase()}</td><td class="header-label">Learning Area</td><td class="header-val">${data.subject}</td></tr><tr><td class="header-label">Teaching Date/s</td><td class="header-val">${dateDisplay}</td><td class="header-label">Quarter</td><td class="header-val">${data.quarter}</td></tr><tr><td class="header-label">Teaching Time</td><td class="header-val">${data.teachingTime}</td><td class="header-label">Section</td><td class="header-val">${data.section}</td></tr></table>`;
        let gridRows = `<tr><td class="dll-row-header">II. CONTENT</td>${isDLP ? '<td id="d1-topic" class="parsed-md"></td>' : '<td id="d1-topic" class="parsed-md"></td><td id="d2-topic" class="parsed-md"></td><td id="d3-topic" class="parsed-md"></td><td id="d4-topic" class="parsed-md"></td><td id="d5-topic" class="parsed-md"></td>'}</tr><tr><td colspan="${colSpan+1}" style="background:#e5e7eb; font-weight:bold;">III. LEARNING RESOURCES</td></tr><tr><td class="dll-row-header">A. References</td><td colspan="${colSpan}" id="cell-resources" class="parsed-md"></td></tr><tr><td colspan="${colSpan+1}" style="background:#e5e7eb; font-weight:bold;">IV. PROCEDURES</td></tr>`;
        const steps = [{id:'a',l:'A. Review'},{id:'b',l:'B. Purpose'},{id:'c',l:'C. Presenting new lesson'},{id:'d',l:'D. Discussing concepts #1'},{id:'e',l:'E. Discussing concepts #2'},{id:'f',l:'F. Mastery'},{id:'g',l:'G. Application'},{id:'h',l:'H. Generalization'},{id:'i',l:'I. Evaluation'},{id:'j',l:'J. Additional'}];
        steps.forEach(s => { gridRows += `<tr><td class="dll-row-header">${s.l}</td>`; if(isDLP) { gridRows += `<td id="d1-proc-${s.id}" class="parsed-md"></td>`; } else { for(let i=1; i<=5; i++) gridRows += `<td id="d${i}-proc-${s.id}" class="parsed-md"></td>`; } gridRows += `</tr>`; });
        document.getElementById('contentArea').innerHTML = `<table class="tpl-table"><tr><th style="width:150px"></th>${colsHTML}</tr><tr><td colspan="${colSpan+1}" style="background:#e5e7eb; font-weight:bold;">I. OBJECTIVES</td></tr><tr><td class="dll-row-header">A. Content Standards</td><td colspan="${colSpan}" id="cell-cs" class="parsed-md">${data.cs}</td></tr><tr><td class="dll-row-header">B. Performance Standards</td><td colspan="${colSpan}" id="cell-ps" class="parsed-md">${data.ps}</td></tr><tr><td class="dll-row-header">C. Learning Competencies</td><td colspan="${colSpan}" id="cell-lc" class="parsed-md">${data.lc}</td></tr>${gridRows}<tr><td class="dll-row-header">V. REMARKS</td><td colspan="${colSpan}" style="height:30px"></td></tr><tr><td class="dll-row-header">VI. REFLECTION</td><td colspan="${colSpan}" style="height:30px"></td></tr></table>`;
    }

    function cleanOutput(text) {
        if(!text) return "";
        let clean = text.replace(/Support Pollinations\.AI[\s\S]*/gi, '').replace(/```xml/gi, '').replace(/```/gi, '');
        const technicalTerms = [/\(Detailed Content Topic\)/gi, /\(Step [A-J] content\)/gi, /Discussing #[1-2] \(?\)?/gi, /Presenting examples \(?\)?/gi, /Application \(?\)?/gi, /Generalization \(?\)?/gi, /Consolidation and Reflection \(Assessment and Closure\)/gi, /Assessment, Resources, and Closure/gi, /\[?(ACTIVITY|ANALYSIS|ABSTRACTION|APPLICATION|ENGAGE|EXPLORE|EXPLAIN|ELABORATE|EVALUATE|ELICIT|EXTEND) PHASE\]?/gi];
        technicalTerms.forEach(regex => { clean = clean.replace(regex, ''); });
        return clean.trim();
    }

    async function generatePlan() {
        const d = getInputs();
        if(!d.docType || !d.grade || !d.quarter || !d.subject || !d.model || !d.topic || !d.cs || !d.ps || !d.lc) { Swal.fire({icon:'error',title:'Required',text:'Please fill all mandatory fields.'}); return; }
        renderEmptyLayout();
        const btn = document.querySelector('.btn-generate'); const spin = document.getElementById('spin');
        btn.disabled = true; spin.style.display = 'inline-block';
        const isDLP = d.docType === 'DLP';
        const activeDays = d.dates.map((v, i) => v ? i+1 : null).filter(v => v);
        const prompt = `Act as DepEd Teacher. Topic: "${d.topic}" Subject: ${d.subject}. Model: ${d.model}. Objectives: ${d.cs}, ${d.ps}, ${d.lc}. MANDATORY: Do not use placeholders. Generate actual lesson material for Step C. For ${d.docType}, generate content for: ${isDLP ? 'Day 1' : 'Days ' + activeDays.join(',')}. XML: <CS>Standards+3 subjs</CS><RESOURCES>Refs</RESOURCES> And for D1: <D1_TOPIC>Lesson details</D1_TOPIC><D1_A>...</D1_A> to <D1_J>...</D1_J>.`;
        try {
            const resp = await fetch('https://text.pollinations.ai/', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ messages: [{ role: 'system', content: 'Generate lesson plans using XML tags. No placeholders.' }, { role: 'user', content: prompt }], model: 'openai' }) });
            let text = cleanOutput(await resp.text());
            document.getElementById('cell-cs').innerHTML = marked.parse(extractSection(text, 'CS') || d.cs);
            document.getElementById('cell-resources').innerHTML = marked.parse(extractSection(text, 'RESOURCES') || "");
            const max = isDLP ? 1 : 5;
            for(let i=1; i<=max; i++) {
                if(d.docType === 'DLL' && !d.dates[i-1]) continue;
                document.getElementById(`d${i}-topic`).innerHTML = marked.parse(extractSection(text, `D${i}_TOPIC`) || "");
                ['a','b','c','d','e','f','g','h','i','j'].forEach(s => {
                    const val = extractSection(text, `D${i}_${s.toUpperCase()}`);
                    if(val) document.getElementById(`d${i}-proc-${s}`).innerHTML = marked.parse(val);
                });
            }
            Swal.fire({icon:'success',title:'Done'});
        } catch(e) { Swal.fire({icon:'error',title:'Error',text:e.message}); } 
        finally { btn.disabled = false; spin.style.display = 'none'; }
    }
    function downloadPDF() { html2pdf().set({margin:0.2,filename:'LessonPlan.pdf',jsPDF:{unit:'in',format:'a4',orientation:'landscape'}}).from(document.getElementById('paperContent')).save(); }
    function exportToWord() {
        const blob = new Blob(["<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><style>@page { size: 29.7cm 21cm; mso-page-orientation: landscape; } table { border-collapse: collapse; width: 100%; table-layout: fixed; } td, th { border: 1px solid black; padding: 5px; vertical-align: top; word-wrap: break-word; }</style></head><body>" + document.getElementById('paperContent').innerHTML + "</body></html>"], {type: 'application/msword'});
        const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = 'LessonPlan.doc'; link.click();
    }
    toggleInputs();
</script>
</body>
</html>
